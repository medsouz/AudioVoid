<% layout('layout') -%>
<div class="mdl-grid">
	<div class="mdl-cell mdl-cell--4-col mdl-color--white mdl-color-text--black">
		<div class="mdl-card mdl-shadow--2dp mdl-color-text--grey-100" style="background: url('<%= getGravatar(user.email) %>') no-repeat center; height: 300px; width: 100%; background-size: cover;">
			<div class="mdl-card__title mdl-card--expand"></div>
			<div class="mdl-card__actions" style="background-color: rgba(0, 0, 0, 0.5)">
				<% if (!req.user || req.user.id != user.id) { /* Only show follow button if logged in and not on your own profile */ %>
					<button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--grey-100" style="float:right" onclick="followUser(<%= user.id %>)">Follow</button>
				<% } else { %>
					<button id="demo-menu-lower-right" class="mdl-button mdl-js-button mdl-button--icon" style="float: right">
						<i class="material-icons">more_vert</i>
					</button>
					<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="demo-menu-lower-right">
						<a class="mdl-menu__item" href="http://en.gravatar.com/">Change Picture (Gravatar)</a>
						<li class="mdl-menu__item" onclick="$('#profileSettings')[0].showModal();">Edit Profile</li>
					</ul>
				<% } %>
				<b style="font-size: 1.5em"><%= user.username %></b>
			</div>
		</div>
	</div>
	<div class="mdl-cell mdl-cell--4-col mdl-color--white mdl-color-text--black scroll" style="padding: 15px; padding-top: 0px; height: 300px">
		<h3 class="center">About Me</h3>
		<p><%= user.bio %></p>
	</div>
	<div class="mdl-cell mdl-cell--4-col mdl-color--white mdl-color-text--black scroll" style="padding: 15px; padding-top: 0px">
		<% if (!req.user || req.user.id != user.id) { /* Only show follow button if logged in and not on your own profile */ %>
			<h3 class="center">Social</h3>
			<table>
				<tr>
					<td><i class="fa fa-twitter" style="color: #0000FF"></i></td>
					<td>Twitter - @<%= user.twitter %></td>
				</tr>
				<tr>
					<td><i class="fa fa-soundcloud" style="color: #FF7700"></i></td>
					<td>Soundcloud - <%= user.soundcloud %></td>
				</tr>
			</table>
		<% } else { %>
			<h3 class="center">Post</h3>
			<form action="/user/post" method="post">
				<textarea class="center" style="width: 90%; display: block; margin-bottom: 10px; height: 140px; resize: none;" name="post"></textarea>
				<button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect mdl-color--red-600 center" type="submit" value="Create Post">Create Post</button>
			</form>
		<% } %>
	</div>
	<div class="mdl-cell mdl-cell--6-col">
	<% for(var song in songs) { %>
		<div class="mdl-cell mdl-cell--12-col mdl-color--white mdl-color-text--black-100 mdl-shadow--2dp">
			<div class="mdl-grid">
				<div class="mdl-cell mdl-cell--2-col center">
					<img src="/uploads/<%= songs[song].id %>.png" style="width: 100%;">
				</div>
				<div class="mdl-cell mdl-cell--10-col vertical-flex-parent">
					<div class="mdl-tooltip mdl-tooltip--large" for="btnPlaySong<%= song %>">Play</div>
					<div class="mdl-tooltip mdl-tooltip--large" for="btnQueueSong<%= song %>">Add to queue</div>
					<span>
						<button id="btnPlaySong<%= song %>" class="mdl-button mdl-js-button mdl-button--icon" onclick="playSong('/uploads/<%= songs[song].id %>.mp3', '<%= songs[song].title %>');">
							<i class="material-icons">play_arrow</i>
						</button>
						<button id="btnQueueSong<%= song %>" class="mdl-button mdl-js-button mdl-button--icon" onclick="addSong('/uploads/<%= songs[song].id %>.mp3', '<%= songs[song].title %>');">
							<i class="material-icons">playlist_add</i>
						</button>
						<b><%= songs[song].title %></b> - <i><%= songs[song].genre %></i>
					</span>
					<span><%= songs[song].description %></span>
					<div class="mdl-card--expand"></div>
					<div>
						<div class="mdl-tooltip mdl-tooltip--large" for="btnLikeSong<%= song %>">Like</div>
						<button id="btnLikeSong<%= song %>" class="mdl-button mdl-js-button mdl-button--icon">
							<i class="material-icons">favorite</i>
						</button>
						<span>100</span>

						<div class="mdl-tooltip mdl-tooltip--large" for="btnRepostSong<%= song %>">Repost</div>
						<button id="btnRepostSong<%= song %>" class="mdl-button mdl-js-button mdl-button--icon">
							<i class="material-icons">repeat</i>
						</button>
						<span>100</span>
						<div class="mdl-tooltip mdl-tooltip--large" for="btnAddtoplaylist<%= song %>">Add to playlist</div>
						<button id="btnAddtoplaylist<%= song %>" class="mdl-button mdl-js-button mdl-button--icon">
							<i class="material-icons">playlist_add</i>
						</button>
						<span>100</span>
						<div class="mdl-tooltip mdl-tooltip--large" for="btnshare<%= song %>">Share</div>
						<button id="btnshare<%= song %>" class="mdl-button mdl-js-button mdl-button--icon">
							<i class="material-icons">screen_share</i>
						</button>
						<span>100</span>
					</div>
				</div>
			</div>
		</div>
	<% } %>
	</div>
	<div class="mdl-cell mdl-cell--6-col">
	<% for(var post in posts) { %>
		<div class="mdl-cell mdl-cell--12-col mdl-color--white mdl-color-text--black-100 mdl-shadow--2dp">
			<div class="mdl-grid">
				<div class="mdl-cell mdl-cell--2-col center">
					<img src="<%= getGravatar(user.email) %>" style="width: 100%;">
				</div>
				<div class="mdl-cell mdl-cell--10-col vertical-flex-parent">
					<div><%= posts[post].message %></div>
					<div class="mdl-card--expand"></div>
					<div>
						<div class="mdl-tooltip mdl-tooltip--large" for="btnLike<%=post%>">Like</div>
						<button id="btnLike<%=post%>" class="mdl-button mdl-js-button mdl-button--icon">
							<i class="material-icons">favorite</i>
						</button>
						<span>100</span>
						<div class="mdl-tooltip mdl-tooltip--large" for="btnRepost<%=post%>">Repost</div>
						<button id="btnRepost<%=post%>" class="mdl-button mdl-js-button mdl-button--icon">
							<i class="material-icons">repeat</i>
						</button>
						<span>100</span>
					</div>
				</div>
			</div>
		</div>
	<% } %>
	</div>
</div>

<dialog id="profileSettings" class="mdl-dialog">
	<h4 class="mdl-dialog__title">Settings</h4>
	<form action="/user/settings" method="post">
		<div class="mdl-dialog__content">
			<h5>Bio</h5>
			<textarea name="bio"><%= user.bio %></textarea>
			<h5>Twitter</h5>
			<input type="text" name="twitter" maxlength="15" value="<%= user.twitter %>"></input>
			<h5>Soundcloud</h5>
			<input type="text" name="soundcloud" maxlength="30" value="<%= user.soundcloud %>"></input>
			<br>
		</div>
		<div class="mdl-dialog__actions">
			<button type="submit" class="mdl-button">Save</button>
			<button type="button" class="mdl-button close" onclick="$('#profileSettings')[0].close();">Cancel</button>
		</div>
	</form>
</dialog>
